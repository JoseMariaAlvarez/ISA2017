{% extends "base.html" %}
{% block content %}

{% if error_formulario %}
<div class="row">
  
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="alert alert-danger alert-dismissible fade in" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>
        <strong>{{error_formulario}}</strong>
      </div>
    </div>
  </div>
{% endif %}
  <form action="/modvisitas/{{ id }}/" method="POST" id="form">
    <div class="col-md-3 col-sm-3 col-xs-12">
      <div class="x_panel">
      	<div class="x_title">
      		<h2>Modificar Visita</h2>
      		<div class="clearfix"></div>
      	</div>
      	<div class="x_content">
    		 {% csrf_token %}
    		  {% for field in formVisita %}
    		    <div class="form-group">
    		      {% if field.name != 'paciente' %}
    		        <label for="{{ field.name }}">{{ field.label }}:</label>
    		      {% endif %}
    		      {{ field }}
    		    </div>
    		  {% endfor %}
    		  <div class="form-group">
            <label>Comentarios:</label>
    		  	<textarea id="comentarios" class="form-control" rows="4" disabled>{{ comentariosAntiguos }}</textarea>
    		  </div>
    		  {% for comentario in formComentario %}	
    			<div class="form-group">
    				{% if comentario.label != 'Autor' %}
    			    	<label for="{{comentario.name}}">Nuevo {{comentario.label}}:</label>
    		    	{% endif %}
    			    {{ comentario }}
    			</div>
    		  {% endfor %}
      	</div>
      </div>
    </div>
    <div class="col-md-9 col-sm-9 col-xs-12">
      <div class="x_panel">
        <div class="x_title">
          <h2>Dosificación</h2>
          <div class="clearfix"></div>
        </div>
        <div class="x_content" id="panel_dosificacion">
        </div>
      </div>
    </div>
  </form>
  <div style="padding: 15px">
    <a class="btn btn-danger" href="/gestor/">Cancelar</a>
    <a class="btn btn-success" onclick="submit_formulario()">Cambiar</a>
    <a href="#" id="nuevo_comentario" class="btn btn-info" onclick="anadir_comentario()">Añadir comentario</a>
  </div>
</div>
 
 {% endblock %}

 {% block javascript %}
<script type="text/javascript">
    dosificacion_inicial = $.trim("{{distribucion_inicial}}").split(" ");
    heparina_inicial = $.trim("{{heparina_inicial}}").split(" ");
    var ruta_imagen = "/static/INR/images/";
    var id_visita = {{id}};
    $( document ).ready(function() {
      $("#fecha").datepicker({
        dateFormat: "yy-mm-dd",
        firstDay: 1,
        minDate: 0,
        dayNames: ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"],
        dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
        monthNames: [ "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre" ],
      });

      construir_vista_dosificacion(dosificacion_inicial, "#panel_dosificacion");
      insertar_input_dosificacion(dosificacion_inicial, "#panel_dosificacion");
   
    });

</script>

<style type="text/css">
  tr.vertical { display: inline-block;}
  th.vertical, td.vertical { display: block; } 

  .table-th{
    width: 5%;
    float: left;
  }

  .wrap {
    height: 200px;
    max-width: 87%;
    overflow-x: auto;
    white-space: nowrap;
    float: left;
    }

  input[type="checkbox"][id^="cb"] {
    display: none;
  }

  label img {
    height: 30px;
    width: 30px;
  }
  :checked + label.btn {
    background-color: #5cb85c;
  }

   label.btn {
    background-color: #ddd ;
   }

   p {
    padding-left: 9px;
   }

   i {
    cursor: pointer;
   }
</style>
{% endblock %}